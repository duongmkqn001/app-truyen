<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>T√¨m ki·∫øm theo th·ªÉ lo·∫°i - App Truy·ªán</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <link rel="stylesheet" href="css/theme-variables.css">
    <link rel="stylesheet" href="css/styles.css">
</head>
<body class="bg-gradient-to-br from-green-50 to-blue-50 min-h-screen">
    <!-- Navigation Bar -->
    <nav class="bg-white shadow-md sticky top-0 z-50">
        <div class="container mx-auto px-4 py-3">
            <div class="flex items-center justify-between">
                <a href="index.html" class="text-xl sm:text-2xl font-bold text-green-600">üìö App Truy·ªán</a>

                <div class="hidden md:flex items-center gap-4">
                    <a href="index.html" class="text-gray-700 hover:text-green-600">Trang ch·ªß</a>
                    <a href="authors.html" class="text-gray-700 hover:text-green-600">T√°c gi·∫£</a>
                    <a href="search-by-tag.html" class="text-green-600 font-semibold">T√¨m theo th·ªÉ lo·∫°i</a>
                    <a href="ranking.html" class="text-gray-700 hover:text-green-600">B·∫£ng x·∫øp h·∫°ng</a>
                    <a href="my-reading-list.html" class="text-gray-700 hover:text-green-600">üìñ Danh s√°ch ƒë·ªçc</a>
                    <a href="upload.html" class="text-gray-700 hover:text-green-600">T·∫£i l√™n</a>

                    <!-- User Menu -->
                    <div id="userMenu"></div>
                </div>

                <!-- Mobile Menu -->
                <div class="md:hidden flex items-center gap-2">
                    <div id="userMenu"></div>
                    <a href="index.html" class="px-3 py-2 text-sm text-gray-700 hover:text-green-600 touch-manipulation">Trang ch·ªß</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container mx-auto px-3 sm:px-4 py-4 sm:py-8">
        <div class="max-w-6xl mx-auto">
            <h1 class="text-2xl sm:text-3xl font-bold text-gray-800 mb-4 sm:mb-6">üè∑Ô∏è T√¨m ki·∫øm theo th·ªÉ lo·∫°i</h1>
            
            <!-- Instructions -->
            <div class="bg-blue-50 border-l-4 border-blue-500 rounded-lg p-4 mb-6">
                <div class="flex items-start gap-3">
                    <div class="text-2xl">üí°</div>
                    <div class="flex-1">
                        <h3 class="font-bold text-blue-900 mb-2">H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng:</h3>
                        <!-- Desktop Instructions -->
                        <ul class="hidden md:block text-sm text-blue-800 space-y-1">
                            <li>‚Ä¢ <strong>Click tr√°i</strong> v√†o th·ªÉ lo·∫°i ƒë·ªÉ <span class="text-green-700 font-semibold">ch·ªçn</span> (t√¨m truy·ªán c√≥ th·ªÉ lo·∫°i n√†y)</li>
                            <li>‚Ä¢ <strong>Click ph·∫£i</strong> v√†o th·ªÉ lo·∫°i ƒë·ªÉ <span class="text-red-700 font-semibold">lo·∫°i tr·ª´</span> (·∫©n truy·ªán c√≥ th·ªÉ lo·∫°i n√†y)</li>
                            <li>‚Ä¢ S·ª≠ d·ª•ng √¥ t√¨m ki·∫øm ƒë·ªÉ l·ªçc th·ªÉ lo·∫°i nhanh ch√≥ng</li>
                            <li>‚Ä¢ Nh·∫•n "Hi·ªán t·∫•t c·∫£" ƒë·ªÉ xem to√†n b·ªô danh s√°ch th·ªÉ lo·∫°i</li>
                        </ul>
                        <!-- Mobile Instructions -->
                        <ul class="md:hidden text-sm text-blue-800 space-y-1">
                            <li>‚Ä¢ <strong>Nh·∫•n</strong> v√†o th·ªÉ lo·∫°i ƒë·ªÉ <span class="text-green-700 font-semibold">ch·ªçn</span> (t√¨m truy·ªán c√≥ th·ªÉ lo·∫°i n√†y)</li>
                            <li>‚Ä¢ <strong>Gi·ªØ l√¢u</strong> v√†o th·ªÉ lo·∫°i ƒë·ªÉ <span class="text-red-700 font-semibold">lo·∫°i tr·ª´</span> (·∫©n truy·ªán c√≥ th·ªÉ lo·∫°i n√†y)</li>
                            <li>‚Ä¢ S·ª≠ d·ª•ng √¥ t√¨m ki·∫øm ƒë·ªÉ l·ªçc th·ªÉ lo·∫°i nhanh ch√≥ng</li>
                            <li>‚Ä¢ Nh·∫•n "Hi·ªán t·∫•t c·∫£" ƒë·ªÉ xem to√†n b·ªô danh s√°ch th·ªÉ lo·∫°i</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Search Filters -->
            <div class="bg-white rounded-lg shadow-lg p-4 sm:p-6 mb-4 sm:mb-6">
                <form id="searchForm" class="space-y-4 sm:space-y-6">
                    <!-- Tag Search Input -->
                    <div>
                        <label class="block text-lg font-semibold text-gray-800 mb-3">
                            üè∑Ô∏è T√¨m ki·∫øm th·ªÉ lo·∫°i
                        </label>
                        <div class="flex flex-col sm:flex-row gap-3 mb-4">
                            <input type="text" id="tagSearchInput"
                                   placeholder="Nh·∫≠p t√™n th·ªÉ lo·∫°i ƒë·ªÉ t√¨m ki·∫øm..."
                                   class="flex-1 px-4 py-3 sm:py-2 text-base border-2 border-green-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-transparent">
                            <button type="button" id="showAllTagsBtn"
                                    class="px-6 py-3 sm:py-2 bg-orange-500 hover:bg-orange-600 active:bg-orange-700 text-white font-semibold rounded-lg transition-colors whitespace-nowrap touch-manipulation">
                                Hi·ªán t·∫•t c·∫£
                            </button>
                            <button type="button" id="hideAllTagsBtn"
                                    class="hidden px-6 py-3 sm:py-2 bg-gray-500 hover:bg-gray-600 active:bg-gray-700 text-white font-semibold rounded-lg transition-colors whitespace-nowrap touch-manipulation">
                                ·∫®n b·ªõt
                            </button>
                        </div>
                    </div>

                    <!-- Selected Tags Display -->
                    <div>
                        <div class="flex items-center justify-between mb-3">
                            <label class="block text-base sm:text-lg font-semibold text-gray-800">
                                ‚úÖ Th·ªÉ lo·∫°i ƒë√£ ch·ªçn
                            </label>
                            <button type="button" id="clearIncludeTags" class="text-sm sm:text-base text-red-600 hover:text-red-700 active:text-red-800 font-medium px-3 py-1 rounded touch-manipulation">
                                X√≥a t·∫•t c·∫£
                            </button>
                        </div>
                        <div id="includeTagsContainer" class="flex flex-wrap gap-2 min-h-[80px] p-4 border-2 border-green-200 rounded-lg bg-green-50">
                            <div id="includeTagsPlaceholder" class="text-gray-400 text-sm">Ch∆∞a ch·ªçn th·ªÉ lo·∫°i n√†o. Nh·∫•n v√†o th·ªÉ lo·∫°i b√™n d∆∞·ªõi ƒë·ªÉ th√™m...</div>
                        </div>
                    </div>

                    <!-- Blacklist Tags Display -->
                    <div>
                        <div class="flex items-center justify-between mb-3">
                            <label class="block text-base sm:text-lg font-semibold text-gray-800">
                                ‚ùå Th·ªÉ lo·∫°i lo·∫°i tr·ª´ (Blacklist)
                            </label>
                            <button type="button" id="clearExcludeTags" class="text-sm sm:text-base text-red-600 hover:text-red-700 active:text-red-800 font-medium px-3 py-1 rounded touch-manipulation">
                                X√≥a t·∫•t c·∫£
                            </button>
                        </div>
                        <div id="excludeTagsContainer" class="flex flex-wrap gap-2 min-h-[80px] p-4 border-2 border-red-200 rounded-lg bg-red-50">
                            <div id="excludeTagsPlaceholder" class="text-gray-400 text-sm"><span class="hidden md:inline">Nh·∫•p chu·ªôt ph·∫£i</span><span class="md:hidden">Gi·ªØ l√¢u</span> v√†o th·ªÉ lo·∫°i ƒë·ªÉ lo·∫°i tr·ª´...</div>
                        </div>
                    </div>

                    <!-- All Available Tags (Organized by Category) -->
                    <div>
                        <label class="block text-lg font-semibold text-gray-800 mb-3">
                            üìö T·∫•t c·∫£ th·ªÉ lo·∫°i
                        </label>
                        <div id="allTagsContainer" class="p-4 border-2 border-gray-200 rounded-lg bg-gray-50 max-h-[500px] overflow-y-auto">
                            <!-- Tags will be loaded here organized by category -->
                        </div>
                    </div>

                    <!-- Optional Filters -->
                    <div class="border-t pt-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">üîç B·ªô l·ªçc b·ªï sung (t√πy ch·ªçn)</h3>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <!-- Title Search (Optional) -->
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">T√™n truy·ªán</label>
                                <input type="text" id="searchTitle" placeholder="Nh·∫≠p t√™n truy·ªán (kh√¥ng b·∫Øt bu·ªôc)..." class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
                            </div>

                            <!-- Author Search (Optional) -->
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">T√°c gi·∫£</label>
                                <input type="text" id="searchAuthor" placeholder="Nh·∫≠p t√™n t√°c gi·∫£ (kh√¥ng b·∫Øt bu·ªôc)..." class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
                            </div>

                            <!-- Status Filter -->
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Tr·∫°ng th√°i</label>
                                <select id="searchStatus" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                    <option value="">T·∫•t c·∫£</option>
                                    <option value="ƒêang ra">ƒêang ra</option>
                                    <option value="Ho√†n th√†nh">Ho√†n th√†nh</option>
                                    <option value="T·∫°m ng∆∞ng">T·∫°m ng∆∞ng</option>
                                </select>
                            </div>

                            <!-- Sort By -->
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">S·∫Øp x·∫øp theo</label>
                                <select id="sortBy" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                    <option value="created_at_desc">M·ªõi nh·∫•t</option>
                                    <option value="created_at_asc">C≈© nh·∫•t</option>
                                    <option value="title_asc">T√™n A-Z</option>
                                    <option value="title_desc">T√™n Z-A</option>
                                    <option value="rating_desc">ƒê√°nh gi√° cao nh·∫•t</option>
                                    <option value="rating_asc">ƒê√°nh gi√° th·∫•p nh·∫•t</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="flex flex-col sm:flex-row gap-3 sm:gap-4">
                        <button type="submit" class="flex-1 bg-green-600 hover:bg-green-700 active:bg-green-800 text-white font-semibold py-3 px-6 rounded-lg transition-colors touch-manipulation">
                            üîç T√¨m ki·∫øm
                        </button>
                        <button type="reset" class="px-6 py-3 border-2 border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 active:bg-gray-100 touch-manipulation">
                            X√≥a t·∫•t c·∫£ b·ªô l·ªçc
                        </button>
                    </div>
                </form>
            </div>

            <!-- Results Count -->
            <div id="resultsCount" class="text-gray-700 mb-4"></div>

            <!-- Search Results -->
            <div id="searchResults" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Results will be loaded here -->
            </div>

            <!-- Pagination -->
            <div id="pagination" class="mt-8 flex justify-center gap-2">
                <!-- Pagination buttons will be loaded here -->
            </div>

            <!-- No Results Message -->
            <div id="noResults" class="hidden text-center py-12">
                <div class="text-6xl mb-4">üè∑Ô∏è</div>
                <h3 class="text-xl font-semibold text-gray-700 mb-2">Kh√¥ng t√¨m th·∫•y truy·ªán</h3>
                <p class="text-gray-500">Th·ª≠ ch·ªçn th·ªÉ lo·∫°i kh√°c ho·∫∑c thay ƒë·ªïi b·ªô l·ªçc</p>
            </div>

            <!-- Initial State Message -->
            <div id="initialState" class="text-center py-12">
                <div class="text-6xl mb-4">üè∑Ô∏è</div>
                <h3 class="text-xl font-semibold text-gray-700 mb-2">Ch·ªçn th·ªÉ lo·∫°i ƒë·ªÉ b·∫Øt ƒë·∫ßu</h3>
                <p class="text-gray-500">Ch·ªçn √≠t nh·∫•t m·ªôt th·ªÉ lo·∫°i mu·ªën xem ho·∫∑c nh·∫•n "T√¨m ki·∫øm" ƒë·ªÉ xem t·∫•t c·∫£</p>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg p-6 flex items-center gap-3">
            <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"></div>
            <span class="text-gray-700 font-medium">ƒêang t√¨m ki·∫øm...</span>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/theme-manager.js"></script>
    <script src="js/config.js"></script>
    <script src="js/database.js"></script>
    <script src="js/components.js"></script>
    <script src="js/novel-modal.js"></script>
    <script src="js/tag-categories.js"></script>
    <script src="js/search-by-tag.js"></script>
</body>
</html>

